<div class="flexrow">

    {{!-- Statbox --}}
    <div class="statbox">
        
        <h4 class="statbox-header flex-group-left">
                
            {{!-- Descriptor(s) --}}
            <span class="list-entries mb-0">
                {{log system.details.descriptors}}
                {{#each system.details.descriptors as |detail id|}}
                <span class="list-entry">
                
                    <a class="array-button" data-action="edit" data-array="details.descriptors" data-entry-id="{{id}}"
                        data-tooltip="{{detail.desc}}">{{detail.name}}</a><span class="buttons">
                        <a class="array-button" data-action="edit" data-array="details.descriptors" data-entry-id="{{id}}"
                            title="{{localize "WW.Detail.Descriptor.Edit"}}"><i class="fas fa-edit"></i></a>
                
                        <a class="array-button" data-action="remove" data-array="details.descriptors" data-entry-id="{{id}}"
                            title="{{localize "WW.Detail.Descriptor.Remove"}}"><i class="fas fa-trash"></i></a>
                    </span>{{#unless @last}},{{/unless}}

                </span>
                {{/each}}
                
                {{#unless system.details.descriptors.length}}{{localize "WW.Detail.Descriptor.None"}}{{/unless}}
                
                <a class="array-button" data-action="add" data-array="details.descriptors" data-loc="Descriptor"
                    title="{{localize "WW.Detail.Descriptor.Add"}}"><i class="fas fa-circle-plus"></i></a>

            </span>

            {{!-- Difficulty --}}
            <span class="statbox-difficulty">{{localize "WW.Stats.Difficulty"}}

                <select name="system.stats.difficulty">
                    {{selectOptions difficulties selected=system.stats.difficulty}}
                </select>

            </span>
        </h4>

        <div class="statbox-section">

            {{!-- Defense, Health, Damage --}}
            <div class="stat-inline flex-wrap">

                {{!-- Defense --}}
                <div class="nowrap">
                    <label>{{localize "WW.Defense.Label"}}:</label>
                
                    <input type="number" name="system.stats.defense.total" value="{{system.stats.defense.total}}" min="0"
                        data-dtype="Number" />
                
                    {{#if system.stats.defense.details}}({{/if}}<input class="auto-resize" type="text"
                        name="system.stats.defense.details" value="{{system.stats.defense.details}}" data-dtype="String"
                        title="{{localize "WW.Defense.Details"}}" />{{#if system.stats.defense.details}}){{/if}}
                </div>

                {{!-- Health --}}
                <div class="nowrap">
                    <label>{{localize "WW.Health.Label"}}:</label>

                    <input type="number" name="system.stats.health.current" value="{{system.stats.health.current}}" min="0"
                    data-dtype="Number" title="{{localize "WW.Health.Bonus"}}: {{system.stats.health.bonus}}. {{localize "WW.Health.Lost"}}: {{system.stats.health.lost}}"/>

                    <span class="stat-edit">{{localize "WW.Stats.Normal"}}: <input type="number" name="system.stats.health.normal" value="{{system.stats.health.normal}}" min="0" /></span>
                    
                </div>

                {{!-- Damage --}}
                <div class="nowrap">
                    <label>{{localize "WW.Damage.Label"}}:</label>
                    
                    <input type="number" name="system.stats.damage.value" value="{{system.stats.damage.value}}" min="0"
                        data-dtype="Number" />

                    <i class="health-indicator fas {{#if incapacitated}}fa-octagon-xmark{{else if injured}}fa-droplet{{/if}}" title="
                        {{#if incapacitated}}{{localize "WW.Health.Incapacitated"}}
                        {{else}}{{localize "WW.Health.Injured"}}{{/if}}">
                    </i>
                </div>
            </div>

            {{!-- Attributes 1 --}}
            <div class="mt-1 stat-inline">
                <label>{{localize "WW.Attributes.Strength"}}:</label>
                <a class="attribute-mod item-button" data-action="attribute-roll" data-key="str" title="Roll Strength"></a>
                <input type="number" name="system.attributes.str.value"
                    value="{{system.attributes.str.value}}" min="0" placeholder="—" data-dtype="Number" /> 
                    
                {{#if system.attributes.str.value}}
                <a class="attribute-mod item-button" data-action="attribute-roll" data-key="str" title="Roll Strength">
                    ({{numberFormat system.attributes.str.mod decimals=0 sign=true}})
                </a>
                {{/if}}

                <label class="ml-1">{{localize "WW.Attributes.Agility"}}:</label>
                <input type="number" name="system.attributes.agi.value"
                    value="{{system.attributes.agi.value}}" min="0" placeholder="—" data-dtype="Number" /> 
                
                {{#if system.attributes.agi.value}}
                <a class="attribute-mod item-button" data-action="attribute-roll" data-key="agi" title="Roll Agility">
                    ({{numberFormat system.attributes.agi.mod decimals=0 sign=true}})
                </a>
                {{/if}}

            </div>

            {{!-- Attributes 2 --}}
            <div class="mt-1 stat-inline">
                <label>{{localize "WW.Attributes.Intellect"}}:</label>
                <input type="number" name="system.attributes.int.value"
                    value="{{system.attributes.int.value}}" min="0" placeholder="—" data-dtype="Number" /> 
                
                {{#if system.attributes.int.value}}
                <a class="attribute-mod item-button" data-action="attribute-roll" data-key="int" title="Roll Intellect">
                    ({{numberFormat system.attributes.int.mod decimals=0 sign=true}})
                </a>
                {{/if}}

                <label class="ml-1">{{localize "WW.Attributes.Will"}}:</label>
                <input type="number" name="system.attributes.wil.value"
                    value="{{system.attributes.wil.value}}" min="0" placeholder="—" data-dtype="Number" /> 
                
                {{#if system.attributes.wil.value}}
                <a class="attribute-mod item-button" data-action="attribute-roll" data-key="wil" title="Roll Will">
                    ({{numberFormat system.attributes.wil.mod decimals=0 sign=true}})
                </a>
                {{/if}}
            </div>

            {{!-- Size, Speed --}}
            <div class="stat-inline list-entries">

                {{!-- Size --}}
                <label>{{localize "WW.Stats.Size"}}:</label>
                <select name="system.stats.size">
                    {{selectOptions numbersArr selected=system.stats.size nameAttr="key" labelAttr="label"}}
                </select>
                
                {{!-- Speed --}}
                <label class="ml-1">{{localize "WW.Stats.Speed"}}:</label>

                {{system.stats.speed.current}}
                <span class="stat-edit">{{localize "WW.Stats.Normal"}}: <input type="number" name="system.stats.speed.normal" value="{{system.stats.speed.normal}}" min="0" /></span>
                
                {{!-- Movement Traits --}}
                {{#each system.details.movementTraits as |detail id|}}<span class="list-entry">
                    {{#if @first}}({{/if}}<a class="array-button" data-action="edit" data-array="details.movementTraits" data-entry-id="{{id}}"
                        data-tooltip="{{detail.desc}}">{{detail.name}}</a><span class="buttons">
                        
                        <a class="array-button" data-action="edit" data-array="details.movementTraits" data-entry-id="{{id}}"
                            title="{{localize "WW.Movement.Edit"}}"><i class="fas fa-edit"></i></a>
                        
                        <a class="array-button" data-action="remove" data-array="details.movementTraits" data-entry-id="{{id}}"
                            title="{{localize "WW.Movement.Remove"}}"><i class="fas fa-trash"></i></a>
                    </span>{{#unless @last}},{{/unless}}{{#if @last}}){{/if}}
                </span>
                {{/each}}

                <a class="array-button" data-action="add" data-array="details.movementTraits" data-loc="Movement"
                    title="{{localize "WW.Movement.Add"}}"><i class="fas fa-circle-plus"></i></a>

            </div>
            
        </div>

        <div class="statbox-section talents-section">

            {{!-- Languages --}}
            <div class="stat-inline list-entries">
                
                <label>{{localize "WW.Detail.Language.Label"}}:</label>
                
                {{#each system.details.languages as |detail id|}}
                <span class="list-entry">
                
                    <a class="array-button" data-action="edit" data-array="details.languages" data-entry-id="{{id}}"
                        data-tooltip="{{detail.desc}}">{{detail.name}}</a><span class="buttons">
                        
                        <a class="array-button" data-action="edit" data-array="details.languages" data-entry-id="{{id}}"
                            title="{{localize "WW.Detail.Language.Edit"}}"><i class="fas fa-edit"></i></a>
                
                        <a class="array-button" data-action="remove" data-array="details.languages" data-entry-id="{{id}}"
                            title="{{localize "WW.Detail.Language.Remove"}}"><i class="fas fa-trash"></i></a>
                    </span>{{#unless @last}},{{/unless}}
                </span>
                {{/each}}
                
                {{#unless system.details.languages.length}}—{{/unless}}
                
                <a class="array-button" data-action="add" data-array="details.languages" data-loc="Language"
                    title="{{localize "WW.Detail.Language.Add"}}"><i class="fas fa-circle-plus"></i></a>

            </div>

            {{!-- Senses --}}
            <div class="stat-inline list-entries">
                <label>{{localize "WW.Detail.Sense.Label"}}:</label>

                {{#each system.details.senses as |detail id|}}
                <span class="list-entry">
                
                    <a class="array-button" data-action="edit" data-array="details.senses" data-entry-id="{{id}}"
                        data-tooltip="{{detail.desc}}">{{detail.name}}</a><span class="buttons">
                        <a class="array-button" data-action="edit" data-array="details.senses" data-entry-id="{{id}}"
                            title="{{localize "WW.Detail.Sense.Edit"}}"><i class="fas fa-edit"></i></a>
                
                        <a class="array-button" data-action="remove" data-array="details.senses" data-entry-id="{{id}}"
                            title="{{localize "WW.Detail.Sense.Remove"}}"><i class="fas fa-trash"></i></a>
                    </span>{{#unless @last}},{{/unless}}

                </span>
                {{/each}}
                
                {{#unless system.details.senses.length}}—{{/unless}}
                
                <a class="array-button" data-action="add" data-array="details.senses" data-loc="Sense"
                    title="{{localize "WW.Detail.Sense.Add"}}"><i class="fas fa-circle-plus"></i></a>

            </div>

            {{!-- Immune --}}
            <div class="stat-inline list-entries">

                <label>{{localize "WW.Detail.Immune.Label"}}:</label>

                {{#each system.details.immune as |detail id|}}
                <span class="list-entry">
                    
                    <a class="array-button" data-action="edit" data-array="details.immune" data-entry-id="{{id}}"
                        data-tooltip="{{detail.desc}}">{{detail.name}}</a><span class="buttons">
                        <a class="array-button" data-action="edit" data-array="details.immune" data-entry-id="{{id}}"
                            title="{{localize "WW.Detail.Immune.Edit"}}"><i class="fas fa-edit"></i></a>
                            
                        <a class="array-button" data-action="remove" data-array="details.immune" data-entry-id="{{id}}"
                            title="{{localize "WW.Detail.Immune.Remove"}}"><i class="fas fa-trash"></i></a>
                    </span>{{#unless @last}},{{/unless}}

                </span>
                {{/each}}

                {{#unless system.details.immune.length}}—{{/unless}}

                <a class="array-button" data-action="add" data-array="details.immune" data-loc="Immune"
                    title="{{localize "WW.Detail.Immune.Add"}}"><i class="fas fa-circle-plus"></i></a>        

            </div>

            {{!-- Traits or Talents --}}
            <fieldset class="attacks-list">

                <legend>
                    {{localize "WW.Talents.Traits"}}
                    <a class="item-create" title="Create item" data-type="Trait or Talent" data-subtype="trait"><i class="fas fa-plus-circle"></i></a>
                </legend>

                <ol class="item-list described-list">
                    {{#each talents as |item id|}}
                        {{> "systems/weirdwizard/templates/actors/parts/NPC-summary-item.hbs" item=item id=id}}
                    {{/each}}
                </ol>

            </fieldset>

        </div>

    </div>

    {{!-- Right Column --}}
    <div class="statbox">
        
        <div class="statbox-section">
            <h6>{{localize "WW.Talents.Actions"}}</h6>

            {{!-- Attacks --}}
            <fieldset class="attacks-list">

                <legend>
                    {{localize "WW.Attack.Plural"}}
                    <a class="item-create" title="Create item" data-type="Equipment" data-subtype="weapon"><i class="fas fa-plus-circle"></i></a>
                </legend>
            
                <ol class="item-list described-list">
                    
                    {{#each weapons as |item id|}}
                        {{> "systems/weirdwizard/templates/actors/parts/NPC-summary-weapon.hbs" item=item id=id}}
                    {{/each}}
                </ol>
            
            </fieldset>
            
            {{!-- Special Actions --}}
            <fieldset class="actions-list">

                <legend>
                    {{localize "WW.Talents.SpecialActions"}}
                    <a class="item-create" title="Create item" data-type="Trait or Talent" data-subtype="action"><i class="fas fa-plus-circle"></i></a>
                </legend>
            
                <ol class="item-list described-list">
                    {{#each actions as |item id|}}
                        {{> "systems/weirdwizard/templates/actors/parts/NPC-summary-item.hbs" item=item id=id}}
                    {{/each}}
                </ol>

            </fieldset>

        </div>

        <div class="statbox-section">

            <h6>{{localize "WW.Talents.Reactions"}}<a class="item-create ml-auto" title="Create item" data-type="Trait or Talent" data-subtype="reaction"><i
                class="fas fa-plus"></i></a></h6>
            
            <ol class="item-list described-list">
                {{#each reactions as |item id|}}
                    {{> "systems/weirdwizard/templates/actors/parts/NPC-summary-item.hbs" item=item id=id}}
                {{/each}}
            </ol>

        </div>
        
        <div class="statbox-section">

            <h6>{{localize "WW.Talents.Ends"}}<a class="item-create ml-auto" title="Create item" data-type="Trait or Talent" data-subtype="end"><i
                class="fas fa-plus"></i></a></h6>
            
            <ol class="item-list described-list">
                {{#each end as |item id|}}
                    {{> "systems/weirdwizard/templates/actors/parts/NPC-summary-item.hbs" item=item id=id}}
                {{/each}}
            </ol>

        </div>

    </div>
</div>